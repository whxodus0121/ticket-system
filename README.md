# 🎫 고성능 티켓 예매 시스템 (Ticket Reservation System)

고성능 동시성 제어와 데이터 정합성을 목표로 하는 티켓 예매 백엔드 시스템입니다.
각 단계를 거치며 발생하는 문제들을 해결해 나가는 과정을 기록합니다.

## 🚀 개발 로드맵 및 버전별 기록

### 🔴 v1. 초동 개발 (기본 기능 구현)
- **목표**: 티켓 예매를 위한 기본적인 REST API 구현
- **문제점**: 
    - **Race Condition 발생**: 여러 사용자가 동시에 예매할 때 재고가 마이너스로 내려가는 현상 발생.
    - 데이터 정합성이 전혀 보장되지 않는 상태.
- **결과**: 동시성 요청 시 재고 초과 판매 발생.

---

### 🟡 v2. 동시성 제어 (Redis Distributed Lock)
- **목표**: 분산 환경에서도 안전한 재고 관리 시스템 구축
- **해결 방법**:
    - **Redis 분산 락(Redlock)** 도입: 티켓별 고유 키를 사용하여 한 번에 하나의 요청만 재고를 수정하도록 제한.
    - 예외 처리 로직 추가: 락을 획득하지 못한 요청에 대해 재시도 또는 실패 응답 처리.
- **결과**: 1,000명의 동시 요청에도 정확히 설정된 재고만큼만 예매 성공 (데이터 정합성 확보).

---

### 🟢 v3. 비즈니스 로직 강화 (1인 1매 제한)
- **목표**: 동일 사용자의 중복 예매(어뷰징) 방지
- **해결 방법**:
    - **Double-Checked Locking 패턴** 적용:
        1. 락 진입 전 1차 체크 (DB 조회)
        2. 분산 락 획득 후 2차 최종 체크 (데이터 무결성 보장)
    - HTTP 400(Bad Request) 응답을 통한 중복 요청 차단.
- **성과**: 
    - 동일 ID로 1,000번의 동시 요청 시, **단 1건만 성공**하고 나머지는 모두 차단됨을 검증.
    - 부하 상황에서 MySQL의 `SLOW SQL` 로그를 포착하여 성능 개선 포인트(v4) 발견.

---
## 🛠 Tech Stack
- **Language**: Go (Golang)
- **Database**: MySQL 8.0 (GORM)
- **Cache & Lock**: Redis
- **Container**: Docker, WSL2
- **Test**: Stress Testing with Goroutines

## 🚦 실행 방법 (How to Run)
1. **Docker 컨테이너 실행**
   ```bash
   docker start my-mysql my-redis
